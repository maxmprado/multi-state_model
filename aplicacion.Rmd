---
title: ''
output: pdf_document
---
En esta primera parte mostraremos como descargar los datos directamente de la URL del INEGI

```{r}
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(tidyr))
#modelo multi estado para las relaciones conyugales

# Descargamos los datos directamente del INEGI
archivoTemporal<- tempfile()
zip <-  "https://www.inegi.org.mx/contenidos/programas/eder/2017/microdatos/eder2017_bases_csv.zip"
download.file(zip,archivoTemporal)
datos <- read.csv(unz(archivoTemporal,"historiavida.csv"))
unlink(archivoTemporal)
```

Lo siguiente será preparar los datos. Eliminaremos aquellas columnas que correspondan a variables que no son de interés para nuestro estudio y filtraremos la información de aquellos individuos que cumplen las caracterísiticas que buscamos, es decir, no haber tenido más de una relación de manera simultánea y quitaremos la información que corresponda de la tercera relación conyugal en adelante.

```{r}
# Crearemos la variable id concatenando 3 variables 
# Creamos la variable residencia del individuo
# Esta información la extraemos de folioviv 
datos <- datos  %>% mutate(id = paste0(datos$folioviv,datos$foliohog,datos$id_pobla),
                           resid = ifelse(substr(datos$folioviv,3,3)=="6","Rural","Urbana")
)
```

